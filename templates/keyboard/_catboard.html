  	<div class="content html_format">
    	<img src="http://habrastorage.org/getpro/habr/post_images/e3e/097/f9c/e3e097f9c927dd888bd4b29db38e7b86.jpg"><br>
<br>
CatBoard — это самодельная эргономичная компактная клавиатура с открытым исходным кодом, имеет множество нестандартных решений, таких как: нестандартная аппаратная раскладка со стандартными клавиатурными сочетаниями; быстрый автоповтор нажатой клавиши; Fn слой с клавишами управления курсором, цифровым блоком, функциональными клавишами; отдельные клавиши переключения раскладок; более удобное расположение Ctrl и Shift; отдельную кнопку AltTab; режим совместимости с Macintosh, позволяющий работать на нём точно так же, как и на PC; возможность прошивки без дополнительного оборудования; возможность устанавливать поверх ноутбучной клавиатуры. Благодаря открытому коду, с клавиатурой можно делать что угодно, новая прошивка заливается в считанные секунды, поэтому экспериментировать можно прямо на ходу.<br>
<a name="habracut"></a><br>
<br>
<div class="spoiler"><b class="spoiler_title">Длинная историческая часть</b><div class="spoiler_text">Всё началось ещё в 2005 году, когда я захотел работать за действительно эргономичной клавиатурой, но не готов был заказывать из заграницы дорогую клавиатуру. Решил разработать клавиатуру самостоятельно, ведь чего проще, купить кнопки, взять контроллер из любой дешёвой клавиатуры, и просто подключить кнопки точно так же, как это сделано в этой клавиатуре. Мне в то время очень понравилась клавиатура <a href="http://www.kinesis-ergo.com/contoured.htm">Kinesis Advantage</a>, практически идеал, но подумал, что стоит начать изготовление с плоской клавиатуры, навроде <a href="http://maltron.com/keyboard-info/maltron-dual-hand-flat-2d-keyboard">Maltron Flat</a>.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/040/910/f98/040910f98631a6ca652c98cafa9474f6.jpg"><br>
<em>Клавиатура Maltron Flat</em><br>
<br>
Печатать вслепую я тогда уже умел, научился благодаря клавиатурному тренажёру <strong>Stamina</strong>. До этого пробовал научиться в Solo, но он настолько меня достал, что я так и не доучился, прошёл все упражнения, но печатать вслепую так и не стал. А вот в Stamina учиться было легко, и когда скорость печати достигла уровня в 200 символов в минуту, я смог начать работать не глядя на клавиатуру. Учился печатать сразу и русский и английский текст, по очереди проходил упражнения, благодаря этому сразу смог полноценно начать работать слепым методом. Переставлял кнопки на своей клавиатуре, тем самым тролля коллег, было интересно даже придумывать разные надписи на клавиатуре, ведь колпачки у кнопок разные на разных рядах, поэтому приходилось переставлять их только на свой же ряд, и желательно было не трогать fj, на которых были засечки (а они важны при слепой печати, чтобы можно было ставить руки в стартовую позицию печати не глядя).<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/804/8ac/521/8048ac52114168f1cd2ae7aec8afbf1f.png"><br>
<em>Клавиатурный тренажёр Стамина</em><br>
<br>
Прежде чем что-нибудь делать, нашёл одну московскую фирму, в которой купил кнопки <strong>Cherry MX Black</strong> с запасом, и программируемую клавиатуру для торговых терминалов <strong>KBM-105</strong> для экспериментов (индекс 105 это количество кнопок, матрица 15x7). Нарисовав схему расположения кнопок, стал думать как мне в домашних условиях сделать корпус. Из подручных материалов собирал разные конструкции, которые сейчас и показать то стыдно, в общем ничего не получалось, было и криво, и хлипко. Работа по изготовлению корпуса застопорилась, зато на программируемой KBM-105 стал экспериментировать с раскладками.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/4b7/64b/0a0/4b764b0a08c7194a99a6db77c555d31b.jpg"><br>
<em>Программируемая клавиатура KBM-105</em><br>
<br>
В то время производилась очень уж необычная клавиатура <strong>NSK 535</strong>, всё в ней было революционно, и алфавитная раскладка, и шифты на больших пальцах. Глядя на такое чудо, решил даже пробовал печатать именно с такими шифтами, но показалось очень уж революционным, и вернул шифты обратно на мизинцы, благо, что прошивать клавиатуру KBM-105 очень быстро, можно по несколько раз на дню менять расположение кнопок.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/0c8/b38/b5b/0c8b38b5bc57559fb8fb17dd8d09f14e.jpg"><br>
<em>Клавиатура NSK 535 R</em><br>
<br>
Проработал я на этой программируемой клавиатуре дома несколько лет, при этом на работе была вполне себе стандартная клавиатура, никаких проблем с работой на двух, совершенно разных клавиатурах, не было, только на моей работать было гораздо приятнее.<br>
<br>
Для быстрого освоения новых раскладок на программируеймой клавиатуре даже написал онлайн клавиатурный тренажёр <strong>Klavarog</strong> (<a href="http://klava.org/">http://klava.org/</a>), чтобы можно было работать с любого компьютера, подключённого к интернету, не устанавливая никаких программ, сейчас все стали так делать, а в то время онлайн тренажёры если и были, то только на Flash, и они не работали в линуксе с русскими буквами. Сначала это был очень простой тренажёр, не было даже подсказки о нажимаемых клавишах, только лишь картинка клавиатуры. Хотя до сих пор он остаётся самым простым тренажёром, при этом очень эффективным, ведь он делался для себя. Новичкам предлагается режим, позволяющий буквально за день освоить расположение всех букв, не нужно тратить неделю или две на прохождение уроков, которые добавляют по одной изучаемой кнопке, как это делается почти во всех тренажёрах.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/f57/89e/8d3/f5789e8d3070110c00a04059d0fcd938.png"><br>
<em>Клавиатурный тренажёр Klavarog</em><br>
<br>
В какой-то момент времени решил что буду разрабатывать новую клавиатуру, и проект будет открытым. Создал <strong>Wiki</strong> сайт <a href="http://kbd.klava.org/">http://kbd.klava.org/</a>, где стал собирать информацию о разных клавиатурах, и стал искать любую информацию по разработке клавиатуры, ведь для моей клавиатуры уже нужно было делать и свой контроллер, стандартный уже не подходил. Оказалось, что я вообще ничего не знал об изготовлении клавиатур.<br>
<br>
Произошло ещё то, что я уволился из офиса и стал работать дома, да ещё и на ноутбуке, матричная программируемая клавиатура использовалась всё реже. Со временем уже и пыл пропал, обычные заботы и дела отодвинули на задний план разработку клавиатуры. Но идея была слижком уж навязчивой, и я начал потихоньку думать, как можно переделать клавиатуру в ноутбуке, ведь физически переделать её было невозможно, поэтому в ход пошли программные средства. Сначала я перенёс клавиши управления курсором на основной алфавитный блок, если зажать AltGr (правый Alt), то некоторые буквы становились стрелками, поначалу это были VIM-овские кнопки <code>hjkl</code>, потом сделал более привычное и удобное <code>ijkl</code>, получилось так, что при зажатом AltGr стрелки как будто сами прыгают под пальцы. Потом разместил клавишу Ctrl слева от пробела, сместив Alt влево на одну клавишу, это оказалось очень <a href="http://ibnteo.klava.org/keyboard/arrow2">удачным решением</a>. Под это дело даже научился работать в Emacs, оказывается на древних клавиатурах <strong>Ctrl</strong> располагался на месте современного Caps Lock, понятно, почему мне раньше не понравился этот редактор, это из-за неудобного расположения Ctrl. Нужно учесть, это всё касается только слепого набора, при печати двумя пальцами расположение клавиш не имеет большого значения, дело лишь в привычке.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/a84/2e1/851/a842e1851c22eae8bb9fbe8efffe3d3c.jpg"><br>
<em>Доработанная раскладка клавиатуры ноутбука</em><br>
<br>
В одно время получилось так, что не было работы, и я решил сменить ненавистную раскладку QWERTY (как же у меня от неё болели мизинцы при обучении слепой печати) на более эргономичную <strong>Dvorak</strong>, и с помощью своего тренажёра стал изучать его. Как раз в это время сделал специальный режим в Klavarog, в котором предлагается набирать одно короткое слово много раз подряд, сначала медленно, потом уже быстро, вбивая новую раскладку в свою память, очень эффективно. Занимался уже где-то неделю, дело шло туго, скорость росла очень медленно, при этом почему-то разучился работать в QWERTY, у других такой проблемы не было, но я испугался, вдруг надо будет что-то срочное делать, а я разучился печатать, а в Dvorak ещё не научился. И вот в этот момент безвременья мне попадается на глаза мой старый компьютер БК-0010/01, в котором была фонетическая раскладка <strong>JCUKEN</strong>, в ней латинские буквы расположены там же, где и схожие по звучанию русские в стандартной раскладке ЙЦУКЕН. Ностальгия по временам БК настолько захлестнула, что я решил сделать себе эту раскладку, и попробовать изучить её. Сделать один в один не получилось, некоторые часто встречаемые буквы были очень не удачно расположены, и я в итоге довольно <a href="http://ibnteo.klava.org/keyboard/jcuken">сильно поменял её</a>, и у меня есть веские причины на перестановку каждой клавиши. Но в общем она всё равно осталась фонетической, и по большей части совпадающей со старой. Сделав раскладку и прошив её в свою операционную систему (я в это время уже начал работать в Ubuntu Linux), я начал изучать её в тренажёре. И тут произошло чудо, процесс пошёл настолько быстро, что я довёл скорость печати до 200 символов в минуту (опять эти 200) за пять дней, и начал работать уже в новой раскладке.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/02b/9f4/e1c/02b9f4e1c68e140cfe967b39c2275534.jpg"><br>
<em>Клавиатура советского компьютера БК 0010-01</em><br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/8fc/fc4/e2c/8fcfc4e2c2ed2e6b3c45fc0e8d51afc7.png"><br>
<em>Доработанная раскладка JCUKEN</em><br>
<br>
Теперь меня устраивало всё, кроме расположения клавиш, и не устраивал длинный пробел, хотя на ноутбуке он и короче, чем на обычных клавиатурах, за счёт дополнительных клавиш на нижнем ряду. Пришла пора делать клавиатуру, только она должна стать компактной, чтобы её можно было ставить поверх ноутбучной клавиатуры, и как можно меньшей по высоте. Так как клавиатура должна располагаться поверх ноутбучной, а на моём Thinkpad прямо в середине клавиатуры есть тачпоинт, который выше уровня всех кнопок, то решил сделать на нижней части корпуса клавиатуры отверстие, сначала оно было круглым, потом просто так добавил кошачьи уши. С этого момента моя клавиатура стала называться <strong>CatBoard</strong> =^.^=<br>
<br>
Корпус решил сделать из алюминия, и стал искать производство, где бы мне могли вырезать лазером отверстия под кнопки, и контур корпуса. Никто не хочет связываться с мелкими заказами, большинство честно пишут о сумме минимального заказа, некоторые об этом говорят лишь после заказа. Для резки алюминия нужен довольно мощный лазер, найти такой не просто, поэтому решил делать корпус из листового пластика или оргстекла. И тут, благодаря Хабру, нашёл упоминание о первом открвышемся в России <strong>фаблабе</strong>. Связался с заведующим лаборатории <a href="http://fablab77.ru/">FabLab77</a>, встретились, я рассказал о своём проекте, и получил доступ к оборудованию, с помощью которого можно делать что угодно, открылись безграничные возможности. Тут ещё повезло тем, что в это время приезжали американцы из MIT, и провели недельный семинар, на котором научили работать со всем их оборудованием, использовался только открытый софт.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/77d/673/b6b/77d673b6b8840475fe6c7285ce9f0c34.jpg"><br>
<em>Последний день семинара MIT в FabLab77</em><br>
<br>
В поисках эргономичного расположения кнопок я изготовил множество макетов из фанеры, на которых нашёл самое лучшее расположение, и оно оказалось почти таким же, как и в клавиатурах <a href="http://www.trulyergonomic.com/">Truly Ergonomic</a> и <a href="http://ergodox.org/">ErgoDox</a> (о её существовании я тогда ещё не знал). Ну это и не удивительно, руки у людей ведь почти одинаковые.<br>
<br>
После того, как корпус был готов, а расположение кнопок меня полностью устраивало, я стал изучать, как же мне сделать контроллер. Одновременно стал собирать домашнюю мини лаболаторию для пайки. Купил паяльник с регулировкой мощности, собрал ящик, в котором разместил Dremel 300 с приставкой, превращающей его в небольшой сверлильный станок — Dremel Workstation 220. В этом ящике сделал откидывающуюся крышку, на которой можно работать. Теперь ящик всегда стоит под столом, на занимая место в квартире, а когда нужно что-то сделать, достаю и ставлю его на стол.<br>
<br>
Сначала контроллер решил собрать сам, заодно собрав и программатор, в фаблабе на фрезеровочном станке Modela изготовил печатные платы, спаял их, но ничего так и не заработало, так как работающий программатор был только в фаблабе, покупать новый не хотелось, а возиться с платами мог только дома. Узнал что существуют микроконтроллеры с аппаратной реализацией USB протокола, дальнейший поиск навёл меня на уже готовые контроллеры, такие как Teensy, и аналогичные наши разработки от <a href="http://microsin.ru/">Microsin</a>, у которого и приобрёл <strong>AVR-USB162</strong>.<br>
<br>
Провода решил припавивать не напряму к контроллеру, а через разъем, который установил внутри корпуса. Съездив ещё раз в фаблаб, вырезал лазером корпус, который решил сделать не с закругленными краями, обведя прямыми линиями блоки с кнопками получил текущий дизайн клавиатуры. Контроллер разместил прямо сверху корпуса, держится он на винте с гайкой, и подложенными шайбами, а разъём не даёт плате крутиться. Чтобы провод не упирался в экран ноутбука, расположил контроллер ближе к середине клавиатуры. А вот как бывает, когда об этой проблеме не подумали:<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/a2e/3c4/499/a2e3c449968729b408ce92befc01e983.jpg"><br>
<em>Ричард Столлман и его ноутбук OLPC с клавиатурой HHKB</em><br>
<br>
При разработке схемы понял, что кнопки нужно подключать через диоды, чтобы не было ситуации, когда при нажатии нескольких кнопок в разных рядах и столбцах контроллер начинал думать, что нажата кнопка с пересекающихся рядов. Это всем известно, но я тогда об этом не знал. В кнопках Cherry MX есть пустое место, в которое можно установить либо диод, либо светодиод. Чтобы не припаивать диоды снаружи, в каждую кнопку установил по маленькому диоду КД522Б, правда напутал полярность, у них оказывается расположение метки не унифицировано, нужно обязательно глядеть в справочнике, где анод, а где катод, поэтому при подключении кнопок к контроллеру учёл свою ошибку.<br>
<br>
Когда всё было собрано, осталось лишь прошить контроллер, поначалу я использовал библиотеку LUFA, но так и не смог с ней разобраться, ведь я никогда не программировал на си, и фактически не знаю этот язык. В поисках другого решения нашёл простой код сканирования клавиатуры, где была применена библиотека от Teensy. Код оказался со множеством ошибок, но исправить их было уже не трудно, самое главное работало. Сделал прошивку за пару дней, и клавиатура заработала, никогда бы не подумал, что смогу создать её так быстро. Потом конечно были недели доводки её до ума, исправление ошибок, добавление невиданных ранее функций. И делал я это всё уже на новой клавиатуре.<br>
<br>
Так как клавиатура получилась разделённой, руки стоят дальше друг от друга, а подставка под руки на ноутбуке на это не рассчитана, поэтому руки стали упираться в углы ноутбука. Решил проблему с помощью двух ковриков для мыши с гелевыми подушечками, обрезал лишнюю часть коврика, и получил удобные подставки для рук к клавиатуре. Благодаря прямой линии корпуса, подушечки были установлены просто идеально.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/aeb/51f/69d/aeb51f69d7b0699bf87ac4e56fe1c931.jpg"><br>
<em>Клавиатура CatBoard поверх ноутбука ASUS EEE PC 701</em><br>
<br>
Какое же было удовольствие, наконец-то начать работать на том, что собрано своими руками, и не имеет тех недостатков, от которых я просто устал, ведь работаю на клавиатуре каждый день, и каждый день меня это гнетёт. Придите в любой компьютерный магазин, и попробуйте купить клавиатуру, в которой нет сдвинутых рядов, наследия механических пишущих машинок, их просто нет. Я бы понял, если бы стандартные клавиатуры были идеально эргономичными, так ведь нет, этот стандарт держится лишь на привычке людей, и все новые пользователи учатся опять на этих клавиатурах, сделаных под старину (не во внешнем виде, по сути).<br>
<br>
При этом главное моё требование — использованию поверх ноутбучной клавиатуры, моя новая клавиатура выполняла, она разместится даже на самом маленьком нетбуке — ASUS EEE PC 701, у которого экран диагональю всего 7 дюймов, как это видно на фотографии чуть выше. Я на этом нетбуке хоть и не работаю, но вполне возможно, что начну теперь использовать, где-нибудь в дороге, ведь теперь не нужно пользоваться его маленькой клавиатуркой, когда приходится пальцы сжимать вместе, чтобы разместить их на маленьких клавишах.<br>
<br>
Первоначально стояли плоские колпачки с прозрачной крышкой, купленные ещё вместе с программируемой клавиатурой, позже поставил чёрные колпачки от <a href="http://www.wasdkeyboards.com/">WASD Keyboards</a>, когда сделал заказ на новые кнопки, на сей раз уже Cherry MX Blue (с кликом) и Cherry MX Red (как и чёрные без клика, но более мягкие).<br>
<br>
Вторую клавиатуру решил собирать из-за туговатых Cherry MX Black, у них усилие нажатие более 60 грамм, у синих и красных от 45 грамм. Нажимать их ещё было нормально, а вот удерживать в нажатом состоянии, что в связи с наличием Fn слоя требуется часто, уже не получается, палец устаёт.<br>
<br>
К изготовлению CatBoard ][ присоединился коллега <a href="http://habrahabr.ru/users/suenot/" class="user_link">suenot</a>, с которым познакомились на встрече <a href="http://klavogonki.ru/">Клавогонщиков</a>, и один экземпляр попросили сделать для фаблаба. Поэтому вместо пайки проводами решил сделать печатные платы, на каждую клавиатуру по две штуки, на краю платы устанавливается разъём, в который вставляется контроллер, соединяя обе платы, правда из-за нехватка портов пришлось соединять платы пятью проводами.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/f7b/074/119/f7b074119dcc5a31bb1895d2b745b04f.jpg"><br>
<em>Евгений собирает свою белую CatBoard ][</em><br>
<br>
Фрезеровать такие большие платы очень долго, решил их протравить. Обычно подготавливают к травлению с помощью фоторезиста или ЛУТ, я же решил сделать с помощью лазера, наклеил виниловую самоклеющуюся плёнку к фольге платы, лазером вырезал плёнку по контуру дорожек, снял лишнюю, и травил в растворе персульфата аммония. Платы были из геттинакса, и моей ошибкой было резать их ножницами по металлу, они довольно хрупкие, в одном месте отломился кусок вместе с дорожкой. Сверлил уже дома дремелем, не хотелось возиться с фрезеровкой.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/be0/297/9a2/be02979a2c0e2cf38aa10848b441ea7b.jpg"><br>
<em>Травление платы</em><br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/009/fc1/e2d/009fc1e2d48430f27bc7e05f933dd0dd.jpg"><br>
<em>Просверленная плата</em><br>
<br>
Использование 1,5 мм оргстекла вместе с 3 мм цветным пластиком позволило сделать корпус клавиатуры чуть тоньше, чем в первой клавиатуре, сделанной только из 3 мм листов, из-за чего пришлось фрезеровать выступы под защёлки кнопок. Контроллер взял другой модели, более компактный (<strong>AVR-USB162MU</strong>). Установил два светодиода, синий и красный, которые показывают текущую раскладку клавиатуры.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/974/8e0/8d4/9748e08d4f2c033d2f20c20170117a6c.jpg"><br>
<em>Вид снизу</em><br>
<br>
Скрепляются слои клавиатуры <a href="http://ibnteo.klava.org/keyboard/fixture">резьбовыми заклёпками М3 с насечкой</a> и винтами с потайной головкой. Вместо резьбовых заклёпок можно взять более доступные вытяжные, выбить из них гвоздь, и нарезать внутри резьбу М3.<br>
</div></div><br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/6a3/153/efb/6a3153efb14ab990874c92ffcdec06c5.jpg"><br>
<em>CatBoard ][</em><br>
<br>
<h2>Возможности клавиатуры CatBoard</h2><br>
Самое главное, это Fn слой, тот, который работает при зажатой кнопке Fn под правым большим пальцем. Его наличие позволило сделать клавиатуру очень компактной, и при этом полнофункциональной. Аналогичное я делал и на обычной клавиатуре, перенастроив операционную систему, правда не во всех программах это работало, таких как Skype и Sublime Text. Сейчас же мало того, что стало работать с Fn слоем удобнее, за счёт правильного расположения кнопки Fn, так ещё и работает абсолютно во всех программах, да хоть даже в BIOS-е, ведь при зажатой Fn клавиатура отправляет совсем другие коды клавиш, вместо <code>ijkl</code> отправляется нажатие стрелок, <code>uo</code> это Home и End, <code>p;</code> это Page Up и Page Down, <code>h</code> — Enter, <code>nm</code> — Backspace и Delete, <code>,</code> — Insert. Весь цифровой ряд становится функциональным, т.е. Fn+1 это F1, Fn+0 это F10, ну и Fn+-= это F11 и F12.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/c9c/15c/866/c9c15c866926fb787c73958fe2bb7095.png"><br>
<br>
Пробел давно уже жму только правой рукой, поэтому было решено использовать левый пробел в качестве шифта. Это оказалось очень удобным, ведь его можно удерживать и при печати той же рукой, не нужно чередовать мизинцы, буква слева — правый мизинец, буква справа — левый мизинец. С таким шифтом и Caps Lock не нужен, держи его нажатым, и печатай сколько угодно времени.<br>
<br>
На место освободившихся шифтов повесил функцию переключения языка, слева — РУС, справа — ЛАТ, точно так же, как на старых советских компьютерах. При этом оставил на этих кнопках функцию шифтов, если нажать быстро однократно, то произойдёт включение нужной раскладки, а в остальных случаях это шифты, и в некоторых определённых может быть даже Ctrl.<br>
<br>
Левее кнопки Tab разместил отдельную кнопку AltTab, при её нажатии происходит нажатие Alt, отправка нажатия и отпускания Tab, и удерживание Alt. Чтобы переключиться на следующие окна, достаточно нажать рядом расположенную обычную Tab, очень удобно. Однако если же эту новую кнопку нажать при нажатых Alt или Ctrl, то она будет работать как обычная Tab.<br>
<br>
Ctrl и Alt теперь жмутся к пробелу, причём Ctrl ближе к нему. Благодаря отдельным кнопкам для включения раскладок, и отдельной кнопке AltTab, я почти перестал пользоваться кнопками Alt.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/b8c/747/ebb/b8c747ebbb7cd9acb8fd1dec8a057424.png"><br>
<br>
Есть фиксируемый режим, вызываемый по Fn+AltGr, в котором на правой половине клавиатуры появляется цифровой блок, а на левой тот же блок со стрелками.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/4fc/52a/594/4fc52a594f8474c80aa30d14cb2afd26.png"><br>
<br>
Давно уже мечтал попробовать быстрый <strong>автоповтор</strong> нажатой клавиши, о котором писал давным давно Джеф Раскин. Но я сделал даже лучше, для его работы требуется не тройное нажатие клавиши, а двойное, и работает это благодаря не фиксированному времени, а автоподстройке под пользователя. Чем быстрее происходит двойное нажатие кнопки с последующим удержанием, тем быстрее начнётся и будет происходить автоповтор нажатия клавиши. При этом ложные срабатывания бывают очень редко, и не зависят от скорости работы пользователя. Тесты показывают, что этот автоповтор быстрее обычного в два раза. При этом я к нему так быстро привык, что обычным перестал пользоваться, он мне кажется слишком уж медленным, медленно начинается, медленно работает, хотя конечно второй параметр можно легко настроить, а вот первый не получится, иначе при обычной печати будут ложные срабатывания. Единственный минус, турбо-автоповтор не работает в играх, где вообще автоповтор не нужен, а нужна просто нажатая клавиша, поэтому для таких случаев я сделал его отключаемым по Fn+Esc.<br>
<br>
На месте русской буквы Е разместил букву Ё, которая будет набрана при зажатой Fn. Теперь всегда печатаю Ё, до неё ведь не нужно теперь тянуться. К тому же и <code>~</code> в английской раскладке таким образом оказалось удобнее набирать.<br>
<br>
Так как печатаю не в QWERTY, а в <strong>JCUKEN</strong>, и есть отдельные кнопки для переключения языков, то сделал свою нестандартную раскладку аппаратной, и благодаря этому появилась возможность сделать то, чего никто не догадался сделать до меня, а именно — клавиатурные сочетания от QWERTY. Ведь чтобы оставить удобные Ctrl+XCV, сделали раскладку Colemak, а мне достаются не только клавиатурные сочетания для работы с буфером обмена, но и все остальные. Ведь я в своей JCUKEN разместил V на месте W только потому, что Ctrl+W была очень не удобной, и зачастую нажимал её случайно, что приводило к неприятным последствиям. Теперь же возвращаюсь обратно на FYWA, и это стало возможным как раз из-за стандартных клавиатурных сочетаний.<br>
<br>
С появлением дополнительных светодиодов, отображающих текущую раскладку, их хорошо видно боковым зрением, и при этом не мешают работать, всё же сделал функцию их отключения, нажимаешь Fn+Y, и клавиатура больше не светится.<br>
<br>
Часто нужно отлучиться от компьютера, но так как моя клавиатура не позволяет закрыть ноутбук, не убрав её, то сделал функцию <strong>блокировки</strong> клавиатуры. Нажав Fn+RShift, клавиатура отключает светодиоды, перестаёт принимать любые нажатия, кроме этой же комбинации, и отправляет в компьютер нажатие Win+L, комбинацию, которая блокирует операционную систему паролем, чтобы в ваше остсутствие чужой человек не мог воспользоваться вашим компьютером.<br>
<br>
<strong>Прошивается</strong> клавиатура без программаторa, прямо по тому же USB проводу, которым она подключена к компьютеру. Достаточно лишь нажать кнопку на контроллере, как активируется <a href="http://ibnteo.klava.org/avr/at90usb162">загрузчик DFU</a>, расположенный в конце памяти контроллера, и через специальную программу можно залить скомпилированную прошивку в начало памяти контроллера. Я поставил трёхсекундную паузу в скрипте загрузки, поэтому спокойно отправляю данные на загрузку, и успеваю активировать загрузчик, т.е. мне для прошивки не нужна даже другая клавиатура, чтобы нажать Enter. В основном по этой причине я разместил контроллер не внутри корпуса клавиатуры, а прямо сверху, чтобы была доступна кнопка загрузчика. Благодаря этому корпус клавиатуры получился максимально тонким, втиснуть в него контроллер было бы сложно, и пришлось бы ещё разъём выводить наружу, усложняя сборку.<br>
<br>
<h2>Мой взгляд на CatBoard</h2><br>
Так как мне не подошла ни одна из производимых клавиатур, ведь одним из главных требований было использование клавиатуры поверх ноутбучной, то пришлось делать клавиатуру самому. Благодаря FabLab77, я смог изготовить несколько вариантов корпуса, и испытать разное расположение кнопок, в итоге пришёл к такому же расположению кнопок, что в Truly Ergonomics и ErgoDox, разве что только кнопки под большими пальцами расположены совершенно по-другому, они не закрывают тачпад ноутбука, и не стал урезать крайние кнопки слева и справа, клавиатура получилась наиболее совместима со стандартной. Хотя конечно переучиться придётся, особенно левой руке, работе с клавишами навигации, и функциональными клавишами.<br>
<br>
Получилась очень удобная русская клавиатура, заточенная под машинопись (слепую десятипальцевую печать) и программирование, позволяющая использовать нестандартную английскую раскладку при стандартных клавиатурных сочетаниях, при этом совместимая со всеми операционными системами и программами. Я как создал первый экземпляр работающей клавиатуры в новогодние праздники этого года, так и работаю на ней до сих пор, перейти на обычную уже не смогу, а точнее, просто не захочу.<br>
<br>
Память контроллера занята только наполовину (4 Кб загрузчик, и почти 4 Кб контроллер клавиатуры), поэтому остаётся ещё много места для расширения функционала клавиатуры. А самое главное, что сделать это можно самостоятельно, не нужно ждать, когда кто-то реализует необходимое лично мне. Только на своей клавиатуре стало возможным реализовать то, о чём уже давно мечтал, и ещё многое можно сделать, идей полно.<br>
<br>
<h2>Аналоги</h2><br>
Существуют различные действительно эргономичные клавиатуры, однако из-за высокой цены и необходимости привыкать к ним, они пользуются малым спросом, к сожалению.<br>
<br>
<h3>ErgoDox (Key64)</h3><br>
<img src="http://habrastorage.org/getpro/habr/post_images/183/3bc/140/1833bc14041c8994ed743aa6d09d47ae.jpg" alt="ErgoDox"><br>
<br>
После того, как сделал первую версию CatBoard, узнал о существовании аналогичного проекта, только уже доведённого энтузиастами до совместного выпуска. Это клавиатура, состоящая из двух половинок, соединяющихся проводом. Печатная плата разработана таким образом, что для левой и правой половины используются одни и те же платы, только перевёрнутые.<br>
<br>
<h3>Truly Ergonomics</h3><br>
<img src="http://habrastorage.org/getpro/habr/post_images/a2d/bef/bc1/a2dbefbc1b64c96b8fa4234eb5305847.jpg" alt="Truly Ergonomics"><br>
<br>
Подставки под руки снимаются, благодаря чему клавиатура становится ещё компактнее.<br>
<br>
<h3>New Stanadrd Keyboards (NSK 535 R)</h3><br>
<img src="http://habrastorage.org/getpro/habr/post_images/0c8/b38/b5b/0c8b38b5bc57559fb8fb17dd8d09f14e.jpg" alt="NSK 535 R"><br>
<br>
Эта клавиатура слишком революционна, начиная с алфавитной раскладки, благодаря чему её не получится использовать для ввода русских текстов. Очень не удобное расположение стрелок.<br>
<br>
<h3>Maltron</h3><br>
<img src="http://habrastorage.org/getpro/habr/post_images/556/8d9/6e3/5568d96e3e1c3773b444c1cb78e15e7d.jpg" alt="Maltron"><br>
<br>
Выпускается очень давно, есть модификации для одной руки. Довольно дорогая.<br>
<br>
<h3>Kinesis</h3><br>
<img src="http://habrastorage.org/getpro/habr/post_images/f04/c31/d79/f04c31d79af53975b4236448e2c28b2f.jpg" alt="Kinesis"><br>
<br>
Снималась в фильме «Люди в чёрном». Одна из лучших и доступных клавиатур, до сих пор развивается.<br>
<br>
<h2>CatBoard из старой механической клавиатуры</h2><br>
Недавно подарили кнопки Alps White из старой механической клавиатуры, уже выпаянные из неё. Решил и из них собрать CatBoard, монтаж буду производить проводами, так будет гораздо быстрее, чем изготовить печатную плату. Контроллер будет установлен на корпус клавиатуры, и будет удерживаться на трении в разъёме.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/20a/54e/29b/20a54e29b26a97a3d562c6c7ba6d2a56.jpg"><img src="http://habrastorage.org/getpro/habr/post_images/ca3/536/51e/ca353651e070d4105db87806663067b0.png"><br>
<br>
При наличии кнопок и возможности изготовить корпус, повторить клавиатуру довольно легко.<br>
<br>
<h2>Дальнейшие планы</h2><br>
Пока не планирую заниматься производством таких клавиатур. Общение со всеми знакомыми показало, что большинство даже не видят разницы между стандартной клавиатурой и CatBoard, и уж тем более никто не хочет переучиваться.<br>
<br>
Если делать такую клавиатуру относительно дешёвой (на плёнках), то нужен будет заказ на очень большое количество клавиатур. На механических кнопках дешевле $100 не получится сделать никак, и то, это тоже при крупной партии производства. Самостоятельная сборка одной клавиатуры обойдётся в 5-6 т.р.<br>
<br>
Если кто-то захочет получить такую же клавиатуру (или аналогичную по своему проекту), и при этом сам не сможет её сделать, пишите на <a href="mailto:ibnteo@gmail.com">ibnteo@gmail.com</a>, что-нибудь вместе придумаем. А если уж будете сами собирать, то тем более пишите, или можно будет пообщаться по Skype (текстом) — моё скайп имя точно такое же, что и мой ник здесь.<br>
<br>
<img src="http://habrastorage.org/getpro/habr/post_images/bb1/757/2ee/bb17572ee0e88286e10bb6077f2bde1e.jpg" alt="CatBoard II, NSK 535 R, CatBoard"><br>
<em>CatBoard ][, NSK 535 R, CatBoard</em><br>
<br>
<h2>Ссылки</h2><br>
Сайт проекта: <a href="http://catboard.klava.org/ru.html">http://catboard.klava.org/</a><br>
Исходные файлы: <a href="https://github.com/ibnteo/catboard">https://github.com/ibnteo/catboard</a><br>
Блог CatBoard: <a href="http://ibnteo.klava.org/tag/catboard">http://ibnteo.klava.org/tag/catboard</a><br>
<br>
Кнопки Cherry MX и колпачки: <a href="http://www.wasdkeyboards.com/">http://www.wasdkeyboards.com/</a><br>
Контроллеры: <a href="http://microsin.ru/">http://microsin.ru/</a><br>
Крепёж: <a href="http://www.krepmarket.ru/">http://www.krepmarket.ru/</a><br>
Оргстекло: <a href="http://art-landia.ru/category/plexiglas/">http://art-landia.ru/category/plexiglas/</a><br>
FabLab: <a href="http://fablab77.ru/">http://fablab77.ru/</a><br>
Диоды, светодиоды, резисторы, паяльное оборудование и материалы, были куплены в московском митинском радиорынке на третьем этаже: <a href="http://www.tkmitino.ru/">http://www.tkmitino.ru/</a><br>
Некоторые детали были приобретены в Чип и Дипе: <a href="http://www.chipdip.ru/">http://www.chipdip.ru/</a><br>
<br>
Клавиатурный тренажёр: <a href="http://klava.org/">http://klava.org/</a><br>
Клавогонки: <a href="http://klavogonki.ru/">http://klavogonki.ru/</a><br>
Англоязычные клавиатурные форумы: <a href="http://geekhack.org/">http://geekhack.org/</a>, <a href="http://deskthority.net/">http://deskthority.net/</a> 
    	<div class="clear"></div> 	
  	</div>